# Пользовательская документация к проекту rAstro
## Автор: Гладких Анна
### МФТИ(ГУ), ФНБИК, 403 гр., 2016г

## Содержание:
1. Вступление
  + Цель документации
  + Растровые  изображения
  + Применение растровых графических редакторов
2. Техническое задание
  + Постановка задачи
3. Реализация
  + О Qt
  + О Qt Creator
  + О Qt Designer
  + Реализация внешнего вида пользовательского интерфейса в Qt Designer
  + Реализация взаимодействия пользователя с программой
    + На уровне окон создания/открытия/сохранения файла Механизм сигналов и слотов
    + Взаимодействие на полотне. QEvents
4. Как работать с программой
  + Пример создания нового рисунка
5. Встраиваемые библиотеки
  + О подключениии библиотек графики к программе
  + Библиотека 2D графики, встроенная в программу
    + Краткое описание
6. Заключение
  + Что предстоит сделать
  + Список литературы


### Вступление
Цель данной документациии -  показать пользователю возможности проекта, объяснить некоторые технические детали реализации и познакомить конечного пользователя с отчётом о проделанной работе и планами будущей разработки.
Растровое изображение — изображение, представляющее собой сетку пикселей — цветных точек (обычно прямоугольных) на мониторе, бумаге и других отображающих устройствах. Преимуществами растровой графики является то, что она позволяет создать практически любой рисунок без потерь в размере файла, растровые изображения достаточно распространены, высокая скорость обработки сложных изображений. Растровое представление изображения естественно для большинства устройств ввода-вывода графической информации, таких как мониторы (за исключением векторных устройств вывода), матричные и струйные принтеры, цифровые фотоаппараты, сканеры, а также сотовые телефоны.
Растровый графический редактор — специализированная программа, предназначенная для создания и обработки растровых изображений. Растровые графические редакторы позволяют пользователю рисовать и редактировать изображения на экране компьютера, а также сохранять их в различных растровых форматах, таких как, например, JPEG и TIFF, позволяющих хранить растровую графику с незначительным снижением качества за счёт использования алгоритмов сжатия с потерями, PNG и GIF, поддерживающими хорошее сжатие без потерь, и BMP, также поддерживающем сжатие (RLE), но в общем случае представляющем собой несжатое «попиксельное» описание изображения.
Наиболее известными растровыми графическими редакторами являются Paint, Adobe Photoshop, также стоит отметить открытый растровый графический редактор GIMP, в улучшении которого может участвовать любой пользователь. Подобные программные продукты нашли широкое применение в работе художников-иллюстраторов, фотографов, при подготовке изображений к печати типографским способом или на фотобумаге, публикации в интернете.
***
### Техническое задание
Необходимо было реализовать простой растровый графический редактор с удобным пользовательским интерфейсом. 
В ходе разработки ТЗ было решено ввести и были реализованы следующие обязательные функции программы:
* Рисование кривых линий с помощью инструмента "Карандаш";
* Рисование эллипсов и прямоугольников с помощью инструментов "Эллипс" и "Прямоугольник" соответственно;
* Выбор цвета и толщины линий пользователем;
* Возможность создать/открыть/сохранить файл изображения пользователем
***
### Реализация
#### Qt
	Qt -  кроссплатформенный инструментарий разработки ПО на языке программирования C++. Есть также «привязки» ко многим другим языкам программирования: Python — PyQt, PySide; Ruby — QtRuby; Java — Qt Jambi; PHP — PHP-Qt и другие. Со времени своего появления в 1996 году библиотека Qt легла в основу тысяч успешных проектов во всём мире. Кроме того, Qt является фундаментом популярной рабочей среды KDE, входящей в состав многих дистрибутивов Linux.
	Qt позволяет запускать написанное с его помощью ПО в большинстве современных операционных систем путём простой компиляции программы для каждой ОС без изменения исходного кода. Включает в себя все основные классы, которые могут потребоваться при разработке прикладного программного обеспечения, начиная от элементов графического интерфейса и заканчивая классами для работы с сетью, базами данных и XML. Qt является полностью объектно-ориентированным, легко расширяемым и поддерживающим технику компонентного программирования.
	Qt предоставляет множество классов для программирования. В данном проекте широко использовались классы QDialog, QPainter, QFile, QEvent. и их дочерние классы. Все эти классы наследуются от базового класса Qt - QObject. Также был использован модуль QtWidgets.
***
#### Qt Creator
	Qt Creator — кроссплатформенная свободная IDE (integrated development environment) для разработки на С, С++ и QML. Разработана Trolltech (Digia) для работы с фреймворком Qt. Включает в себя графический интерфейс отладчика и визуальные средства разработки интерфейса как с использованием QtWidgets, так и QML. Основная задача Qt Creator — упростить разработку приложения с помощью фреймворка Qt на разных платформах. 
	Одним из инструментов Qt Creator является среда Qt Designer.
***
#### Qt Designer
	Qt Designer — кроссплатформенная свободная среда для разработки графических интерфейсов (GUI) программ использующих библиотеку Qt. Входит в состав Qt framework. Позволяет создать внешний вид интерфейса пользователя, задать стиль интерфейса, сгруппировать его элементы и назначить различные отношения между ними, а также обеспечивает быстрый доступ к редактированию действия при использовании элемента. Очень удобен.
***
#### Реализация внешнего вида пользовательского интерфейса в Qt Designer
	Был определен размер основного окна и расположение на нём групп кнопок. На самом верху - menuBar, под ним счётчик толщины линий и увеличения изображения. Слева сбоку расположены основные инструменты в виде иконок. Полотно для изображения появляется автоматически при создании/открытии нового файла изображения.
	menuBar представляет себя строку из трёх стандартных вариантов меню - File, Edit и Help, которые обеспечивают функции сохранения/загрузки/создания нового файла, выбора цвета линий, очистки экрана и инструментов редактирования изображения с помощью интегрированной библиотеки 2D графики.
***
#### Реализация взаимодействия пользователя с программой
##### На уровне окон создания/открытия/сохранения файла. Механизм сигналов и слотов
	Необходимо было обеспечить взаимодействие пользователя с программой при создании нового файла /открытия/сохранения. Для этого в Qt Designer были созданы дополнительные окна создания нового файла, открытия файла и сохранения. При этом возникла проблема - как обеспечить собственно взаимодействие созданных окон с основной программой? Для этого использовался механизм сигналов и слотов.
	Сигналы и слоты используются для коммуникации между объектами. Механизм сигналов и слотов главная особенность Qt и вероятно та часть, которая отличаетcя от особенностей, предоставляемых другими фреймворками. Сигнал вырабатывается когда происходит определенное событие. Слот это функция, которая вызывается в ответ на определенный сигнал. Сигналы и слоты слабо связаны. Класс, который вырабатывает сигнал не знает и не заботится о том, какие слоты его получат. Механизм сигналов и слотов Qt гарантирует, что если мы подключим сигнал к слоту, слот будет вызван с параметрами сигнала в нужное время.
	Все классы, наследуемые от QObject или его дочерних классов (например, QWidget) могут содержать сигналы и слоты. Сигналы вырабатываются объектами когда они изменяют свое состояние так, что это может заинтересовать другие объекты. При этом он на знает и не заботится о том что у его сигнала может не быть получателя.
Слоты могут быть использованы для получения сигналов, но они так же нормальные функции-члены. Так же как объект не знает ничего о получателях своих сигналов, слот ничего не знает о сигналах, которые к нему подключены. Это гарантирует что полностью независимые компоненты могут быть созданы с помощью Qt.
Мы можем подключать к одному слоту столько сигналов, сколько захотим, также один сигнал может быть подключен к стольким слотам, сколько необходимо.
	В объявлении классов сигналы и слоты задаются ключевыми словами signals и slots, которые можно комбинировать с другими ключевыми словами, например, private signals, public slots.
	Ключевое слово emit позволяет выслать сигнал. Например:
>void DialogOpen::OkClicked()
>{
>    emit FilePath(ui->lineEdit->text());
>
>    close();
>}

	Соединить сигнал со слотом можно, используя фукнцию QObject::connect():
> connect(wnd, SIGNAL(FilePath(QString)), this, SLOT(OpenMyFile(QString)));

	Сигналы вырабатываются объектами когда они изменяют свое состояние так, что это может заинтересовать другие объекты. Только класс, который определяет сигнал или его потомки могут вырабатывать сигнал. Сигналы автоматически генерируются программой moc (meta - object compiler) и не должны быть реализованы в исходном коде. Они могут не возвращать значение.
	Слот вызывается когда вырабатывается сигнал, с которым он связан. Слот это обычная функция в C++ и может вызываться обычным способом; единственная его особенность, что с ним можно соединять сигналы.

##### Взаимодействие на полотне. QEvents.
По ТЗ, программа должна воспроизводить кривые линии, повторяющие движение мышки пользователя при зажатой левой кнопке мыши. То есть, необходимо было обработать нажатие кнопки мыши, движение мыши и отпускание кнопки мыши. События в Qt предоставили возможность осуществить это.
Для обработки событий нажатия клавиши и рисования использовались классы QMouseEvent и QPaintEvent.
	Пример:
> if(event->button() == Qt::LeftButton && (myTool == 1))
>   {
>       lastPoint = event->pos();
>       scribbling = true;
>   }

Благодаря событиям удалось настроить поведение программы при зажатии мыши на полотне для рисования кривых линий, прямоугольников и эллипсов.
***
### Как работать с программой.
Ниже представлена последовательность действий, обеспечивающих комфортную работу с программой при созданиии нового файла.
1. Запустить программу;
2. Открыть меню File -> New, задать размеры рисунка (ширину и высоту) и нажать Ok. Создастся полотно требуемого размера. Размер может варьироваться от 1 до 999, но программа не поддерживает полностью размер полотна, большего, чем разрешение экрана.
3. Сохранить созданное полотно с помощью File -> Save. В появившемся поле для ввода текста ввести абсолютный путь к файлу с названием и расширением. Рекомендуется использовать расширение *.bmp
4. Выбрать цвет линий с помощью меню Edit -> Set Color.
5. Задать ширину линий с помощью счётчика, расположенного на главном окне.
6. Выбрать инструмент из панели слева и начать рисовать.
	Примечание: Инструменты "Прямоугольник" и "Эллипс" не поддерживают предпросмотр фигур. Необходимо зажать левую кнопку мыши в верхнем левом углу желаемой фигуры и отпустить в нижнем правом. (Эллипс рисуется как вписанный в прямоугольник)
7. Перед окончанием работы сохранить файл изображения.
8. Закрыть программу.

Последовательность действий при открытии изображения приблизительно такая же, кроме того, что открытие происходит с помощью File -> Open, в появившемся диалоговом окне необходимо ввести абсолютный путь к открываемому изображению
**Внимание!** При открытии поддерживается только формат BMP.
***
### Встраиваемые библиотеки
#### Подключение библиотек графики к программе
Данное приложение поддерживает подключение различных библиотек графики, которые расширяют программные возможности проекта и позволяют производить дополнительные манипуляции с изображениями. Для подключения библиотеки необходимо связаться с автором проекта и обсудить детали.
#### Библиотека 2D графики, встроенная в программу
В данной версии программы уже подключена одна сторонняя библиотека - 2D графики, созданная Евтеевой Анастасией. Добавлены элементы графического интерфейса для вызова функций библиотеки. 
Появилась возможность редактировать изображение: поворачивать на 90 градусов против часовой стрелки, отражать относительно вертикальной или горизонтальной оси, накладывать некоторые фильтры, увеличивать размер изображения.
***
### Заключение
#### Что предстоит сделать
Постепенно необходимо реализовывать остальные стандартные возможности основных простых растровых графических редакторов, такие как: 
 * Заливка;
 * Пипетка; 
 * Зум;
 * Нанесение текста на изображение;
 * Рисование многоугольников, прямых/ломаных линий.
 * Выделение области изображение, возможность вырезать эту область, обрезать изображение, копировать или вставить область.

	Хотелось бы добавить также элементы графического интерфейса, облегчающие работу с изображением и расширяющие возможности для использования приложения:
 * Ползунки для прокрутки изображения вверх-вниз, влево-вправо (для больших изображений и полотен);
 * Возможность растягивать полотно, динамически изменяя его размер.
 
***

### Список литературы
 * doc.qt.io
 * ru.wikipedia.org
 * habrahabr.ru
